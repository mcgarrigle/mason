#!/usr/bin/env ruby

$LIB_DIR = File.join(File.dirname(__FILE__), "..", "lib")
$LOAD_PATH << $LIB_DIR

require 'sinatra'
require 'json'
require 'mason'

set :port, 9090

helpers do

  def mason
    @mason ||= Mason.new
  end

end

# ---------------------------------------------

get '/node/:fqdn' do |fqdn|
  mason.get_json(fqdn)
end

put '/node/:fqdn' do |fqdn|
  mason.set(JSON.parse(request.body.read))
end

# ---------------------------------------------
# end
