#!/usr/bin/env ruby

$LIB_DIR = File.join(File.dirname(__FILE__), "..", "lib")
$LOAD_PATH << $LIB_DIR

require 'sinatra'
require 'json'
require 'node'

set :port, 9090

helpers do

  def node
    @node ||= Node.new
  end

end

# ---------------------------------------------

get '/node/:fqdn' do |fqdn|
  node.get_json(fqdn)
end

put '/node/:fqdn' do |fqdn|
  node.set(JSON.parse(request.body.read))
end

# ---------------------------------------------
# end
