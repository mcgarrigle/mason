#!/usr/bin/env ruby

# kickstart HTTP server

# access from NAT interface on VM via:
#  http://10.0.3.2/ipa.ks

require "webrick"

class WEBrick::HTTPServlet::ProcHandler
  alias do_PUT    do_GET
  alias do_DELETE do_GET
end

server = WEBrick::HTTPServer.new(:Port => 9090)

trap('INT') { server.shutdown } 

server.mount_proc '/test' do |req, res|
  res.body = res.inspect
end

server.mount_proc '/node/' do |req, res|
  p req.path
  res.body = "{ 'fqdn': 'server' }"
end

server.start

